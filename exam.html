<!doctype html><html lang="th"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>‡∏ó‡∏≥‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö | AiAm practice exam online</title>
<style>:root{--bg:#f5f9ff;--card:#fff;--accent:#0b74da;--muted:#6b7280;--success:#16a34a;--danger:#dc2626}*{box-sizing:border-box}body{font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;margin:0;background:var(--bg);color:#0f172a}header{background:#0b74da;color:#fff;padding:18px;text-align:center;font-weight:700}.wrap{max-width:880px;margin:28px auto;padding:20px}.card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 6px 20px rgba(11,37,71,.06)}.progress{height:10px;background:#e6eefc;border-radius:999px;overflow:hidden;margin:12px 0}.progress>i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#38bdf8);width:0}.qnum{font-weight:600;color:var(--accent)}.question{margin:8px 0 16px;font-size:18px}.choices{display:flex;flex-direction:column;gap:10px}.choice{border:1px solid #e6eefc;padding:12px;border-radius:10px;cursor:pointer;display:flex;align-items:center;gap:12px}.choice input{accent-color:var(--accent)}.controls{display:flex;justify-content:space-between;gap:12px;margin-top:16px}button{background:var(--accent);color:#fff;border:0;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600}button.ghost{background:transparent;color:var(--accent);border:1px solid #e6eefc}button:disabled{opacity:.5;cursor:not-allowed}.result{padding:14px;border-radius:10px;margin-top:14px}.score{font-size:20px;font-weight:700}.correct{color:var(--success);font-weight:700}.incorrect{color:var(--danger);font-weight:700}footer.small{margin-top:18px;color:var(--muted);font-size:13px}.meta{display:flex;gap:8px;align-items:center;margin:8px 0 12px;color:#64748b}input[type=text]{padding:10px;border:1px solid #e6eefc;border-radius:10px;width:100%}</style>
</head><body><header>‡∏ó‡∏≥‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö ‚Äî AiAm practice exam online</header><div class="wrap"><main class="card" id="app">
<div class="meta"><label for="username">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ó‡∏≥: </label><input id="username" type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà" /><button id="startBtn" class="ghost">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</button></div>
<div class="progress" aria-hidden><i id="progressBar"></i></div><div id="questionArea"></div>
<div class="controls"><button class="ghost" id="prevBtn" disabled>Previous</button><button id="nextBtn" disabled>Next</button></div>
<div id="finalArea"></div></main><footer class="small" style="text-align:center">¬© 2025 AiAm practice exam online ‚Äî ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Firebase</footer></div>
<script type="module">
const firebaseConfig = {
  apiKey: "AIzaSyAD2uYOi5z_9OqleDDM_N0m5skEyXAnhxU",
  authDomain: "toeic-online-e9648.firebaseapp.com",
  projectId: "toeic-online-e9648",
  storageBucket: "toeic-online-e9648.firebasestorage.app",
  messagingSenderId: "1052262804229",
  appId: "1:1052262804229:web:bd06374570c5ab2d44256c",
  measurementId: "G-7SFMZYNS43"
};
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
let currentUser = null;
signInAnonymously(auth).catch(console.error);
onAuthStateChanged(auth, (user)=>{ currentUser = user; });

const params = new URLSearchParams(window.location.search);
const testId = params.get("test") || "toeic-set1";
const examMode = params.get("mode") || (testId==='toeic-set1' ? 'free-full' : (['toeic-set2','toeic-set3','toeic-set4','toeic-set5','toeic-set6','toeic-set7','toeic-set8','toeic-set9'].includes(testId) ? 'free-lite' : 'premium'));

let QUESTIONS = [];
async function loadQuestions() {
  const res = await fetch(`data/${testId}.json`);
  if(!res.ok) throw new Error("‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö: "+testId);
  QUESTIONS = await res.json();
}

let current = 0;
const answers = [];
let userName = "";

const progressBar = document.getElementById('progressBar');
const questionArea = document.getElementById('questionArea');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const startBtn = document.getElementById('startBtn');
const usernameInput = document.getElementById('username');
const finalArea = document.getElementById('finalArea');

startBtn.addEventListener('click', async ()=>{
  const name = usernameInput.value.trim();
  if(!name){ alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö'); return; }
  userName = name;
  prevBtn.disabled = false;
  nextBtn.disabled = false;
  startBtn.disabled = true;
  usernameInput.disabled = true;
  await loadQuestions();
  renderQuestion(current);
});

function renderQuestion(i){
  const item = QUESTIONS[i];
  progressBar.style.width = ((i)/QUESTIONS.length*100+5) + '%';

  questionArea.innerHTML = `
    <div>
      <div class="qnum">‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà ${i+1} ‡∏à‡∏≤‡∏Å ${QUESTIONS.length} ‚Äî <span style='font-size:12px;color:#64748b'>Mode: ${examMode}</span></div>
      <div class="question">${item.q}</div>
      <div class="choices">
        ${item.choices.map((ch, idx)=>
          `<label class='choice'>
            <input type='radio' name='choice' value='${idx}'> ${String.fromCharCode(65+idx)}. ${ch}
          </label>`).join('')}
      </div>
      <div id='feedback' style='margin-top:12px;font-weight:600;'></div>
      <div id='explanation' style='margin-top:6px;color:#64748b;'></div>
    </div>`;

  prevBtn.disabled = i===0;
  nextBtn.textContent = (i===QUESTIONS.length-1)? 'Finish' : 'Next';

  document.querySelectorAll('input[name=choice]').forEach((el,idx)=>{
    el.addEventListener('change',()=>{ onAnswer(i, idx, item); });
  });
}

function onAnswer(i, idx, item) {
  answers[i]=idx;
  const fb=document.getElementById('feedback');
  const ex=document.getElementById('explanation');

  if(examMode === "free-full") {
    if(idx===item.answer) {
      fb.innerHTML = '<span class="correct">‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</span>';
    } else {
      fb.innerHTML = `<span class="incorrect">‚ùå ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</span> (‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å: <strong>${String.fromCharCode(65+item.answer)}. ${item.choices[item.answer]}</strong>)`;
    }
    ex.innerHTML = '‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢: '+item.expl;
  } else if(examMode === "free-lite") {
    fb.innerHTML = (idx===item.answer) ? '<span class="correct">‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</span>' : '<span class="incorrect">‚ùå ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</span>';
    ex.innerHTML = '';
  } else {
    fb.innerHTML = 'üîí ‡πÄ‡∏â‡∏•‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å Premium ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô';
    ex.innerHTML = '';
  }
}

prevBtn.addEventListener('click', ()=>{ if(current>0){ current--; renderQuestion(current); } });
nextBtn.addEventListener('click', ()=>{ if(current<QUESTIONS.length-1){ current++; renderQuestion(current); } else { showResults(); } });

async function showResults(){
  let correct=0;
  QUESTIONS.forEach((q,i)=>{ if(answers[i]===q.answer) correct++; });
  const percent = Math.round(correct/QUESTIONS.length*100);

  finalArea.innerHTML = `
    <div class='result'>
      <div class='score'>üéâ Congratulations! You‚Äôve finished the test.</div>
      <div class='score'>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${correct} / ${QUESTIONS.length} (${percent}%)</div>
      <div style='margin-top:6px;color:#64748b'>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á Firebase...</div>
    </div>`;
  finalArea.scrollIntoView({behavior:'smooth'});

  try {
    if(!currentUser) throw new Error('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏±‡∏ß‡∏ï‡∏ô');
    await addDoc(collection(db, "results"), {
      name: userName,
      score: correct,
      total: QUESTIONS.length,
      percent: percent,
      testId,
      createdAt: serverTimestamp(),
      uid: currentUser.uid
    });
  } catch(err) {
    console.error(err);
    finalArea.innerHTML += `<div style='margin-top:8px;color:#dc2626'>‚ö†Ô∏è ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${err.message}</div>`;
  }
}
</script></body></html>
